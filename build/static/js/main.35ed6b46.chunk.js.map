{"version":3,"sources":["api/getRemByID.js","utils/nthOccurence.js","utils/dom.js","utils/buildData.js","App.js","serviceWorker.js","index.js"],"names":["getRemByID","remId","window","RemNoteAPI","v0","get","nthOccurrence","string","char","nth","first_index","indexOf","length_up_to_first_index","next_occurrence","slice","stripHtml","html","tmp","document","createElement","innerHTML","textContent","innerText","convertStringToHtml","DOMParser","parseFromString","body","firstChild","globalSlotRems","contentRems","getName","name","a","visibleRems","isWithAnchor","Array","isArray","Promise","all","filter","n","i","map","r","text","url","width","existingRem","find","o","_id","push","names","undefined","innerNames","join","getContent","content","nest","innerContent","get_context","context","documentId","documentRem","visibleRemOnDocument","id","e","found","v","nameWithAnchor","nameText","split","item","idx","graphElements","index","title","fifthBreakIndex","processedTitle","substr","data","fullTitle","nodeColor","isDocument","forEach","children","length","c","source","target","target_arrow_shape","some","g","bootstrapData","makePopper","ele","ref","popperRef","dummyDomEle","tippy","onCreate","instance","popperInstance","reference","lazy","plugins","sticky","contentdiv","titleEl","appendChild","contentEl","arrow","placement","hideOnClick","multiple","interactive","appendTo","trigger","Home","useEffect","getGraphElements","filteredGraphElements","s","cytoscape","use","coseBilkent","popper","cy","container","getElementById","elements","style","selector","label","color","height","opacity","layout","quality","nodeDimensionsIncludeLabels","idealEdgeLength","ready","isNode","unbind","bind","event","show","hide","on","sel","difference","outgoers","union","incomers","not","addClass","removeClass","handleFocus","element","fit","$","dataset","Boolean","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","then","registration","unregister","catch","error","console","message"],"mappings":"wUAUeA,EAJI,SAACC,GAClB,OAAOC,OAAOC,WAAWC,GAAGC,IAAIJ,ICenBK,MAtBf,SAASA,EAAcC,EAAQC,EAAMC,GACnC,IAAIC,EAAcH,EAAOI,QAAQH,GAC7BI,EAA2BF,EAAc,EAE7C,GAAY,IAARD,EACF,OAAOC,EAEP,IACIG,EAAkBP,EADcC,EAAOO,MAAMF,GAG/CJ,EACAC,EAAM,GAGR,OAAyB,IAArBI,GACM,EAEDD,EAA2BC,GCjBjC,SAASE,EAAUC,GACxB,IAAIC,EAAMC,SAASC,cAAc,OAEjC,OADAF,EAAIG,UAAYJ,EACTC,EAAII,aAAeJ,EAAIK,WAAa,GAGtC,SAASC,EAAoBhB,GAMlC,OAFa,IAAIiB,WACAC,gBAAP,eAA+BlB,EAA/B,UAA+C,aAC9CmB,KAAKC,WCPlB,IAAMC,EAAiB,GACjBC,EAAc,G,SAILC,E,8EAAf,WAAuBC,GAAvB,mCAAAC,EAAA,yDAA6BC,EAA7B,+BAA2C,GAAIhC,EAA/C,uBAAsDiC,EAAtD,wBACMC,MAAMC,QAAQL,GADpB,iCAEwBM,QAAQC,IAC1BP,EACGQ,QACC,SAACC,GAAD,MACe,kBAANA,GAA0B,MAARA,EAAEC,GAAqB,MAARD,EAAEC,GAAqB,MAARD,EAAEC,KAE5DC,IALH,uCAKO,WAAOC,GAAP,MAAAX,EAAA,SAAAA,EAAA,yDACc,kBAANW,EADR,yCAEMA,GAFN,UAKS,MAARA,EAAEF,EALH,yCAMME,EAAEC,MANR,UASS,MAARD,EAAEF,EATH,4DAUkBE,EAAEE,IAVpB,kBAUiCF,EAAEG,MAVnC,sCAaGC,EAAc,UAAInB,EAAJ,YAAuBK,IAAae,MACtD,SAACC,GAAD,OAAOA,EAAEC,MAAQP,EAAEO,QAdlB,yCAiBM,CACLjD,MAAO8C,EAAYG,IACnBnB,KAAMgB,EAAYhB,OAnBnB,wBAsBa/B,EAAW2C,EAAEO,KAtB1B,eAsBGlB,EAtBH,OAuBHJ,EAAeuB,KAAKnB,GAvBjB,kBAwBI,CACL/B,MAAO+B,EAAEkB,IACTnB,KAAMC,EAAED,OA1BP,4CALP,wDAHN,cAEUqB,EAFV,gBAuC6Bf,QAAQC,IAC/Bc,EAAMV,IAAN,uCAAU,WAAOC,GAAP,SAAAX,EAAA,yDACS,kBAANW,EADH,yCAECA,GAFD,WAIDT,EAJC,gEAKwBjC,EALxB,0BAMF0C,EAAE1C,MANA,2CAOmC6B,EACrCa,EAAEZ,KACFE,OACAoB,GACA,GAXE,wFAaJvB,EAAQa,EAAEZ,KAAME,OAAaoB,GAAW,GAbpC,mFAAV,wDAxCN,cAuCUC,EAvCV,yBAyDWA,EAAWC,KAAK,KAzD3B,iCA2DS,IA3DT,6C,+BA8DeC,E,8EAAf,WAA0BC,GAA1B,mCAAAzB,EAAA,yDAAmCC,EAAnC,+BAAiD,GAAIhC,EAArD,uBAA4DiC,EAA5D,wBACMC,MAAMC,QAAQqB,GADpB,iCAEuBpB,QAAQC,IACzBmB,EACGlB,QACC,SAACC,GAAD,MACe,kBAANA,GAA0B,MAARA,EAAEC,GAAqB,MAARD,EAAEC,GAAqB,MAARD,EAAEC,KAE5DC,IALH,uCAKO,WAAOC,GAAP,MAAAX,EAAA,SAAAA,EAAA,yDACc,kBAANW,EADR,yCAEMA,GAFN,UAKS,MAARA,EAAEF,EALH,yCAMME,EAAEC,MANR,UASS,MAARD,EAAEF,EATH,4DAUkBE,EAAEE,IAVpB,kBAUiCF,EAAEG,MAVnC,sCAaGC,EAAc,UAAIlB,EAAJ,YAAoBI,IAAae,MACnD,SAACC,GAAD,OAAOA,EAAEC,MAAQP,EAAEO,QAdlB,yCAiBM,CACLjD,MAAO8C,EAAYG,IACnBnB,KAAMgB,EAAYhB,OAnBnB,wBAsBa/B,EAAW2C,EAAEO,KAtB1B,eAsBGlB,EAtBH,OAuBHH,EAAYsB,KAAKnB,GAvBd,kBAwBI,CACL/B,MAAO8C,EAAYG,IACnBnB,KAAMgB,EAAYhB,OA1BjB,4CALP,wDAHN,cAEU2B,EAFV,gBAuC+BrB,QAAQC,IACjCoB,EAAKhB,IAAL,uCAAS,WAAOC,GAAP,SAAAX,EAAA,yDACU,kBAANW,EADJ,yCAEEA,GAFF,UAIK,MAARA,EAAEF,EAJC,yCAKEE,EAAEC,MALJ,WAOAV,EAPA,gEAQyBjC,EARzB,0BASD0C,EAAE1C,MATD,2CAUoC6B,EACrCa,EAAEZ,KACFE,OACAoB,GACA,GAdC,wFAgBHvB,EAAQa,EAAEZ,KAAME,OAAaoB,GAAW,GAhBrC,mFAAT,wDAxCN,cAuCUM,EAvCV,yBA4DWA,EAAaJ,KAAK,KA5D7B,iCA8DS,IA9DT,6C,kEAiEA,WAA6BtD,GAA7B,2BAAA+B,EAAA,4FAGY9B,OAAOC,WAAWC,GAAGwD,cAHjC,0BACQC,EADR,kFAOY3D,OAAOC,WAAWC,GAAGC,IAAIwD,EAAQC,YAP7C,mCAKQC,EALR,eASU1B,QAAQC,IACZyB,EAAYC,qBAAqBtB,KAAI,SAACuB,GAAD,OAAQjE,EAAWiE,OAV9D,eAQQhC,EARR,OAYIM,QAAO,SAAC2B,GAAD,OAAOA,EAAEC,SAZpB,UAc+B9B,QAAQC,IACnCL,EAAYS,KAAI,SAAC0B,GAAD,OAAOtC,EAAQsC,EAAErC,KAAME,EAAamC,EAAElB,KAAK,OAf/D,eAcQmB,EAdR,OAiBQC,EAAWD,EAAe3B,KAAI,SAACwB,GAAD,OAClCnD,EAAUmD,GACPK,MAAM,KACN7B,KAAI,SAAC8B,EAAMC,GAAP,OAAgBA,EAAM,IAAM,EAAID,EAAOA,EAAO,QAClDjB,KAAK,QArBZ,UAuBwBlB,QAAQC,IAC5BL,EAAYS,KAAI,SAAC0B,GAAD,OAAOZ,EAAWY,EAAEX,QAASxB,EAAamC,EAAElB,KAAK,OAxBrE,eAuBQO,EAvBR,OA2BExB,EAAYkB,KAAZ,MAAAlB,EAAoBJ,GAEd6C,EAAgBzC,EACnBS,KAAI,SAAC0B,EAAGO,GACP,IAAMC,EAAQN,EAASK,GACjBE,EAAkBvE,EAAcsE,EAAO,IAAK,IAC5CE,EACJD,GAAmB,EAAnB,UAA0BD,EAAMG,OAAO,EAAGF,GAA1C,OAAkED,EACpE,MAAO,CACLI,KAAM,CACJf,GAAIG,EAAElB,IACN0B,MAAOE,EACPG,UAAWZ,EAAeM,GAC1BlB,QAASA,EAAQkB,GACjBO,UAAWd,EAAEe,WAAa,SAAW,WAI1C5C,QAAO,SAAC6B,GAAD,OAAOA,EAAEY,KAAKJ,SAExB3C,EAAYmD,SAAQ,SAAChB,GACfA,EAAEiB,SAASC,OAAS,GACtBZ,EAAcvB,KAAd,MAAAuB,EAAa,YACRN,EAAEiB,SAAS3C,KAAI,SAAC6C,GAAD,MAAQ,CACxBP,KAAM,CACJQ,OAAQpB,EAAElB,IACVuC,OAAQF,EACRG,mBAAoB,iBAMxBvD,MAAMC,QAAQgC,EAAEX,UAClBiB,EAAcvB,KAAd,MAAAuB,EAAa,YACRN,EAAEX,QACFlB,QACC,SAACgD,GAAD,MACU,MAARA,EAAE9C,IACDiC,EAAciB,MACb,SAACC,GAAD,OACEA,EAAEZ,KAAKS,SAAWF,EAAErC,KAAqC,QAA9B0C,EAAEZ,KAAKU,yBAGzChD,KAAI,SAAC6C,GAAD,MAAQ,CACXP,KAAM,CACJQ,OAAQpB,EAAElB,IACVuC,OAAQF,EAAErC,IACVwC,mBAAoB,aAM1BvD,MAAMC,QAAQgC,EAAErC,OAClB2C,EAAcvB,KAAd,MAAAuB,EAAa,YACRN,EAAErC,KACFQ,QACC,SAACgD,GAAD,MACU,MAARA,EAAE9C,IACDiC,EAAciB,MACb,SAACC,GAAD,OACEA,EAAEZ,KAAKS,SAAWF,EAAErC,KAAqC,QAA9B0C,EAAEZ,KAAKU,yBAGzChD,KAAI,SAAC6C,GAAD,MAAQ,CACXP,KAAM,CACJQ,OAAQpB,EAAElB,IACVuC,OAAQF,EAAErC,IACVwC,mBAAoB,gBAhGlC,kBAsGShB,GAtGT,6C,sBAyGemB,M,4CCpOf,SAASC,EAAWC,GAClB,IAAMC,EAAMD,EAAIE,YACVC,EAAchF,SAASC,cAAc,OAC3C4E,EAAII,MAAQA,YAAMD,EAAa,CAC7BE,SAAU,SAAUC,GAClBA,EAASC,eAAeC,UAAYP,GAEtCQ,MAAM,EACNC,QAAS,CAACC,KACVjD,QAAS,WACP,IAAMkD,EAAazF,SAASC,cAAc,OAD7B,EAEkB4E,EAAIf,OAA3BC,EAFK,EAELA,UAAWxB,EAFN,EAEMA,QACbmD,EAAU1F,SAASC,cAAc,MAIvC,GAHAyF,EAAQC,YAAYtF,EAAoB0D,IACxC0B,EAAWE,YAAYD,GAEnBnD,EAAS,CACX,IAAMqD,EAAY5F,SAASC,cAAc,OACzC2F,EAAUD,YAAYtF,EAAoBkC,IAC1CkD,EAAWE,YAAYC,GAGzB,OAAOH,GAETI,OAAO,EACPC,UAAW,SACXC,aAAa,EACbC,UAAU,EAEVC,aAAa,EACbT,QAAQ,EACRU,SAAUlG,SAASQ,KACnB2F,QAAS,WAIE,SAASC,IAuJtB,OAtJAC,qBAAU,WAAM,4CACd,gCAAAvF,EAAA,sEAC8BwF,EAAiB,qBAD/C,OACQ9C,EADR,OAEQ+C,EAAwB/C,EAAcnC,QAAO,SAACE,GAAD,QACjDA,EAAEuC,KAAKJ,OAEHF,EAAciB,MAAK,SAAC+B,GAAD,OAAOA,EAAE1C,KAAKf,KAAOxB,EAAEuC,KAAKQ,WAC/Cd,EAAciB,MAAK,SAAC+B,GAAD,OAAOA,EAAE1C,KAAKf,KAAOxB,EAAEuC,KAAKS,aAErDkC,IAAUC,IAAIC,KACdF,IAAUC,IAAIE,MACRC,EAAKJ,IAAU,CACnBK,UAAW9G,SAAS+G,eAAe,MACnCC,SAAUT,EACVU,MAAO,CACL,CACEC,SAAU,OACVD,MAAO,CACL,mBAAoB,kBACpBE,MAAO,cACPC,MAAO,WACP,YAAa,OACb,YAAa,OACb,qBAAsB,aAG1B,CACEF,SAAU,qBACVD,MAAO,CACLrF,MAAO,EACPyF,OAAQ,IAGZ,CACEH,SAAU,qCACVD,MAAO,CACLrF,MAAO,GACPyF,OAAQ,KAGZ,CACEH,SAAU,oCACVD,MAAO,CACLrF,MAAO,GACPyF,OAAQ,KAGZ,CACEH,SAAU,oCACVD,MAAO,CACLrF,MAAO,GACPyF,OAAQ,KAGZ,CACEH,SAAU,oCACVD,MAAO,CACLrF,MAAO,GACPyF,OAAQ,KAGZ,CACEH,SAAU,qBACVD,MAAO,CACLrF,MAAO,GACPyF,OAAQ,KAGZ,CACEH,SAAU,OACVD,MAAO,CACLrF,MAAO,EACP,aAAc,OACd,qBAAsB,OACtB,qBAAsB,2BACtB,cAAe,SACf,cAAe,EACfuF,MAAO,cACPC,MAAO,QACP,YAAa,MACb,YAAa,SAGjB,CACEF,SAAU,iBACVD,MAAO,CACL,eAAgB,OAChB,eAAgB,QAGpB,CACEC,SAAU,kBACVD,MAAO,CAAEK,QAAS,QAEpB,CACEJ,SAAU,iBACVD,MAAO,CAAE,yBAA0B,SAErC,CACEC,SAAU,kBACVD,MAAO,CAAEK,QAAS,SAGtBC,OAAQ,CACN1G,KAAM,eACN2G,QAAS,UAETC,6BAA6B,EAC7BC,gBAAiB,OAIlBC,OAAM,WACP3I,OAAO6H,GAAKA,EACZA,EAAGG,WAAW9C,SAAQ,SAAUW,GAC1BA,EAAI+C,WACNhD,EAAWC,GACXA,EAAIgD,OAAO,UACXhD,EAAIiD,KAAK,UAAU,SAACC,GAAD,OAAWA,EAAMxD,OAAOU,MAAM+C,UAEjDnD,EAAIgD,OAAO,YACXhD,EAAIiD,KAAK,YAAY,SAACC,GAAD,OAAWA,EAAMxD,OAAOU,MAAMgD,cAIvDpB,EAAGqB,GAAG,YAAa,QAAQ,SAAUlF,GACnC,IAAImF,EAAMnF,EAAEuB,OACZsC,EAAGG,WACAoB,WAAWD,EAAIE,WAAWC,MAAMH,EAAII,aACpCC,IAAIL,GACJM,SAAS,cACZN,EACGM,SAAS,aACTJ,WACAC,MAAMH,EAAII,YACVE,SAAS,gBAEd5B,EAAGqB,GAAG,WAAY,QAAQ,SAAUlF,GAClC,IAAImF,EAAMnF,EAAEuB,OACZsC,EAAGG,WAAW0B,YAAY,cAC1BP,EACGO,YAAY,aACZL,WACAC,MAAMH,EAAII,YACVG,YAAY,mBA/IrB,4CADc,uBAAC,WAAD,wBAoJd/D,KACC,IAED,6BACE,yBAAK5B,GAAG,QAlMd/D,OAAO2J,YAAc,SAAqBC,GACxC,IAAM/B,EAAK7H,OAAO6H,GAClBA,EAAGgC,IAAIhC,EAAGiC,EAAH,WAASF,EAAQG,QAAQzE,OAAzB,cAAqCsE,EAAQG,QAAQxE,SAAW,MCCrDyE,QACW,cAA7BhK,OAAOiK,SAASC,UAEe,UAA7BlK,OAAOiK,SAASC,UAEhBlK,OAAOiK,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFtJ,SAAS+G,eAAe,SDyHpB,kBAAmBwC,WACrBA,UAAUC,cAAc7B,MACrB8B,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAME,c","file":"static/js/main.35ed6b46.chunk.js","sourcesContent":["// import request from \"../utils/request\";\n// import { apiKey, userId } from \"../constants/common\";\n// import getIsLocal from \"../utils/isLocal\";\n\n// const isLocal = getIsLocal();\n\nconst getRemByID = (remId) => {\n  return window.RemNoteAPI.v0.get(remId);\n};\n\nexport default getRemByID;\n","function nthOccurrence(string, char, nth) {\n  var first_index = string.indexOf(char);\n  var length_up_to_first_index = first_index + 1;\n\n  if (nth === 1) {\n    return first_index;\n  } else {\n    var string_after_first_occurrence = string.slice(length_up_to_first_index);\n    var next_occurrence = nthOccurrence(\n      string_after_first_occurrence,\n      char,\n      nth - 1\n    );\n\n    if (next_occurrence === -1) {\n      return -1;\n    } else {\n      return length_up_to_first_index + next_occurrence;\n    }\n  }\n}\n\nexport default nthOccurrence;\n","export function stripHtml(html) {\n  var tmp = document.createElement('div');\n  tmp.innerHTML = html;\n  return tmp.textContent || tmp.innerText || '';\n}\n\nexport function convertStringToHtml(string) {\n  // var wrapper = document.createElement('div');\n  // wrapper.innerHTML = ;\n  // return wrapper.firstChild;\n  var parser = new DOMParser();\n  var doc = parser.parseFromString(`<div>${string}</div>`, 'text/html');\n  return doc.body.firstChild;\n}\n","import getRemByID from \"../api/getRemByID\";\nimport nthOccurrence from \"./nthOccurence\";\nimport { stripHtml } from \"./dom\";\n// import getIsLocal from \"../utils/isLocal\";\n\nconst globalSlotRems = [];\nconst contentRems = [];\n\nconst isLocal = false;\n\nasync function getName(name, visibleRems = [], remId, isWithAnchor) {\n  if (Array.isArray(name)) {\n    const names = await Promise.all(\n      name\n        .filter(\n          (n) =>\n            typeof n === \"string\" || n.i === \"q\" || n.i === \"i\" || n.i === \"m\"\n        )\n        .map(async (r) => {\n          if (typeof r === \"string\") {\n            return r;\n          }\n\n          if (r.i === \"m\") {\n            return r.text;\n          }\n\n          if (r.i === \"i\") {\n            return `<img src=${r.url} width=${r.width} height={r.height} />`;\n          }\n\n          const existingRem = [...globalSlotRems, ...visibleRems].find(\n            (o) => o._id === r._id\n          );\n          if (existingRem) {\n            return {\n              remId: existingRem._id,\n              name: existingRem.name,\n            };\n          }\n          const a = await getRemByID(r._id);\n          globalSlotRems.push(a);\n          return {\n            remId: a._id,\n            name: a.name,\n          };\n        })\n    );\n\n    const innerNames = await Promise.all(\n      names.map(async (r) => {\n        if (typeof r === \"string\") {\n          return r;\n        }\n        return isWithAnchor\n          ? `<a href=\"#\" data-source=\"${remId}\" data-target=\"${\n              r.remId\n            }\" onclick=\"handleFocus(this)\">${await getName(\n              r.name,\n              visibleRems,\n              undefined,\n              false\n            )}</a>`\n          : getName(r.name, visibleRems, undefined, false);\n      })\n    );\n\n    return innerNames.join(\"\");\n  }\n  return \"\";\n}\n\nasync function getContent(content, visibleRems = [], remId, isWithAnchor) {\n  if (Array.isArray(content)) {\n    const nest = await Promise.all(\n      content\n        .filter(\n          (n) =>\n            typeof n === \"string\" || n.i === \"q\" || n.i === \"i\" || n.i === \"m\"\n        )\n        .map(async (r) => {\n          if (typeof r === \"string\") {\n            return r;\n          }\n\n          if (r.i === \"m\") {\n            return r.text;\n          }\n\n          if (r.i === \"i\") {\n            return `<img src=${r.url} width=${r.width} height={r.height} />`;\n          }\n\n          const existingRem = [...contentRems, ...visibleRems].find(\n            (o) => o._id === r._id\n          );\n          if (existingRem) {\n            return {\n              remId: existingRem._id,\n              name: existingRem.name,\n            };\n          }\n          const a = await getRemByID(r._id);\n          contentRems.push(a);\n          return {\n            remId: existingRem._id,\n            name: existingRem.name,\n          };\n        })\n    );\n\n    const innerContent = await Promise.all(\n      nest.map(async (r) => {\n        if (typeof r === \"string\") {\n          return r;\n        }\n        if (r.i === \"m\") {\n          return r.text;\n        }\n        return isWithAnchor\n          ? `<a href=\"#\" data-source=\"${remId}\" data-target=\"${\n              r.remId\n            }\" onclick=\"handleFocus(this)\">${await getName(\n              r.name,\n              visibleRems,\n              undefined,\n              false\n            )}</a>`\n          : getName(r.name, visibleRems, undefined, false);\n      })\n    );\n\n    return innerContent.join(\"\");\n  }\n  return \"\";\n}\n\nasync function bootstrapData(remId) {\n  const context = isLocal\n    ? undefined\n    : await window.RemNoteAPI.v0.get_context();\n\n  const documentRem = isLocal\n    ? await getRemByID(remId)\n    : await window.RemNoteAPI.v0.get(context.documentId);\n  const visibleRems = (\n    await Promise.all(\n      documentRem.visibleRemOnDocument.map((id) => getRemByID(id))\n    )\n  ).filter((e) => e.found);\n\n  const nameWithAnchor = await Promise.all(\n    visibleRems.map((v) => getName(v.name, visibleRems, v._id, true))\n  );\n  const nameText = nameWithAnchor.map((e) =>\n    stripHtml(e)\n      .split(\" \")\n      .map((item, idx) => (idx % 2 === 0 ? item : item + \"\\n\")) // add line break to every second word\n      .join(\" \")\n  );\n  const content = await Promise.all(\n    visibleRems.map((v) => getContent(v.content, visibleRems, v._id, true))\n  );\n\n  visibleRems.push(...contentRems);\n\n  const graphElements = visibleRems\n    .map((v, index) => {\n      const title = nameText[index];\n      const fifthBreakIndex = nthOccurrence(title, \" \", 10);\n      const processedTitle =\n        fifthBreakIndex >= 0 ? `${title.substr(0, fifthBreakIndex)}...` : title;\n      return {\n        data: {\n          id: v._id,\n          title: processedTitle,\n          fullTitle: nameWithAnchor[index],\n          content: content[index],\n          nodeColor: v.isDocument ? \"yellow\" : \"red\",\n        },\n      };\n    })\n    .filter((v) => v.data.title);\n\n  visibleRems.forEach((v) => {\n    if (v.children.length > 0) {\n      graphElements.push(\n        ...v.children.map((c) => ({\n          data: {\n            source: v._id,\n            target: c,\n            target_arrow_shape: \"diamond\",\n          },\n        }))\n      );\n    }\n\n    if (Array.isArray(v.content)) {\n      graphElements.push(\n        ...v.content\n          .filter(\n            (c) =>\n              c.i === \"q\" &&\n              !graphElements.some(\n                (g) =>\n                  g.data.target === c._id && g.data.target_arrow_shape === \"vee\"\n              )\n          )\n          .map((c) => ({\n            data: {\n              source: v._id,\n              target: c._id,\n              target_arrow_shape: \"vee\",\n            },\n          }))\n      );\n    }\n\n    if (Array.isArray(v.name)) {\n      graphElements.push(\n        ...v.name\n          .filter(\n            (c) =>\n              c.i === \"q\" &&\n              !graphElements.some(\n                (g) =>\n                  g.data.target === c._id && g.data.target_arrow_shape === \"vee\"\n              )\n          )\n          .map((c) => ({\n            data: {\n              source: v._id,\n              target: c._id,\n              target_arrow_shape: \"vee\",\n            },\n          }))\n      );\n    }\n  });\n  return graphElements;\n}\n\nexport default bootstrapData;\n","import React, { useEffect } from \"react\";\nimport cytoscape from \"cytoscape\";\nimport popper from \"cytoscape-popper\";\nimport coseBilkent from \"cytoscape-cose-bilkent\";\nimport tippy, { sticky } from \"tippy.js\";\nimport 'tippy.js/dist/tippy.css';\nimport getGraphElements from \"./utils/buildData\";\nimport { convertStringToHtml } from \"./utils/dom\";\n\nwindow.handleFocus = function handleFocus(element) {\n  const cy = window.cy;\n  cy.fit(cy.$(`#${element.dataset.source}, #${element.dataset.target}`), 100);\n};\n\nfunction makePopper(ele) {\n  const ref = ele.popperRef();\n  const dummyDomEle = document.createElement(\"div\");\n  ele.tippy = tippy(dummyDomEle, {\n    onCreate: function (instance) {\n      instance.popperInstance.reference = ref;\n    },\n    lazy: false, // mandatory\n    plugins: [sticky],\n    content: () => {\n      const contentdiv = document.createElement(\"div\");\n      const { fullTitle, content } = ele.data();\n      const titleEl = document.createElement(\"h3\");\n      titleEl.appendChild(convertStringToHtml(fullTitle));\n      contentdiv.appendChild(titleEl);\n\n      if (content) {\n        const contentEl = document.createElement(\"div\");\n        contentEl.appendChild(convertStringToHtml(content));\n        contentdiv.appendChild(contentEl);\n      }\n\n      return contentdiv;\n    },\n    arrow: true,\n    placement: \"bottom\",\n    hideOnClick: false,\n    multiple: true,\n    // if interactive:\n    interactive: true,\n    sticky: true,\n    appendTo: document.body, // or append dummyDomEle to document.body\n    trigger: \"manual\", //when use program to handle\n  });\n}\n\nexport default function Home() {\n  useEffect(() => {\n    async function bootstrapData() {\n      const graphElements = await getGraphElements(\"GH5MRkMCJ6R6aoLbB\");\n      const filteredGraphElements = graphElements.filter((i) =>\n        i.data.title\n          ? true\n          : graphElements.some((s) => s.data.id === i.data.source) &&\n            graphElements.some((s) => s.data.id === i.data.target)\n      );\n      cytoscape.use(coseBilkent);\n      cytoscape.use(popper);\n      const cy = cytoscape({\n        container: document.getElementById(\"cy\"),\n        elements: filteredGraphElements,\n        style: [\n          {\n            selector: \"node\",\n            style: {\n              \"background-color\": \"data(nodeColor)\",\n              label: \"data(title)\",\n              color: \" #66ff66\",\n              \"font-size\": \"10px\",\n              \"text-wrap\": \"wrap\",\n              \"text-overflow-wrap\": \"anywhere\"\n            },\n          },\n          {\n            selector: \"node[[degree = 0]]\",\n            style: {\n              width: 8,\n              height: 8,\n            },\n          },\n          {\n            selector: \"node[[degree >= 1]][[degree <= 3]]\",\n            style: {\n              width: 10,\n              height: 10,\n            },\n          },\n          {\n            selector: \"node[[degree > 3]][[degree <= 5]]\",\n            style: {\n              width: 12,\n              height: 12,\n            },\n          },\n          {\n            selector: \"node[[degree > 5]][[degree <= 7]]\",\n            style: {\n              width: 14,\n              height: 14,\n            },\n          },\n          {\n            selector: \"node[[degree > 7]][[degree <= 9]]\",\n            style: {\n              width: 16,\n              height: 16,\n            },\n          },\n          {\n            selector: \"node[[degree > 9]]\",\n            style: {\n              width: 18,\n              height: 18,\n            },\n          },\n          {\n            selector: \"edge\",\n            style: {\n              width: 1,\n              \"line-color\": \"#ccc\",\n              \"target-arrow-color\": \"#ccc\",\n              \"target-arrow-shape\": \"data(target_arrow_shape)\",\n              \"curve-style\": \"bezier\",\n              \"arrow-scale\": 1,\n              label: \"data(label)\",\n              color: \"green\",\n              \"font-size\": \"7px\",\n              \"text-wrap\": \"wrap\",\n            },\n          },\n          {\n            selector: \"node.highlight\",\n            style: {\n              \"border-color\": \"#FFF\",\n              \"border-width\": \"1px\",\n            },\n          },\n          {\n            selector: \"node.semitransp\",\n            style: { opacity: \"0.2\" },\n          },\n          {\n            selector: \"edge.highlight\",\n            style: { \"mid-target-arrow-color\": \"#FFF\" },\n          },\n          {\n            selector: \"edge.semitransp\",\n            style: { opacity: \"0.2\" },\n          },\n        ],\n        layout: {\n          name: \"cose-bilkent\",\n          quality: \"default\",\n          // Whether to include labels in node dimensions. Useful for avoiding label overlap\n          nodeDimensionsIncludeLabels: true,\n          idealEdgeLength: 50,\n        },\n      });\n\n      cy.ready(function () {\n        window.cy = cy;\n        cy.elements().forEach(function (ele) {\n          if (ele.isNode()) {\n            makePopper(ele);\n            ele.unbind(\"select\");\n            ele.bind(\"select\", (event) => event.target.tippy.show());\n\n            ele.unbind(\"unselect\");\n            ele.bind(\"unselect\", (event) => event.target.tippy.hide());\n          }\n        });\n\n        cy.on(\"mouseover\", \"node\", function (e) {\n          var sel = e.target;\n          cy.elements()\n            .difference(sel.outgoers().union(sel.incomers()))\n            .not(sel)\n            .addClass(\"semitransp\");\n          sel\n            .addClass(\"highlight\")\n            .outgoers()\n            .union(sel.incomers())\n            .addClass(\"highlight\");\n        });\n        cy.on(\"mouseout\", \"node\", function (e) {\n          var sel = e.target;\n          cy.elements().removeClass(\"semitransp\");\n          sel\n            .removeClass(\"highlight\")\n            .outgoers()\n            .union(sel.incomers())\n            .removeClass(\"highlight\");\n        });\n      });\n    }\n    bootstrapData();\n  }, []);\n  return (\n    <div>\n      <div id=\"cy\" />\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}