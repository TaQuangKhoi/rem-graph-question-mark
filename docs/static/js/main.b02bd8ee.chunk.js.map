{"version":3,"sources":["api/getRemByID.js","utils/nthOccurence.js","utils/dom.js","utils/buildData.js","App.js","serviceWorker.js","index.js"],"names":["getRemByID","remId","window","RemNoteAPI","v0","get","nthOccurrence","string","char","nth","first_index","indexOf","length_up_to_first_index","next_occurrence","slice","stripHtml","html","tmp","document","createElement","innerHTML","textContent","innerText","convertStringToHtml","DOMParser","parseFromString","body","firstChild","globalSlotRems","contentRems","getName","name","a","visibleRems","isWithAnchor","Array","isArray","Promise","all","filter","n","_id","map","r","existingRem","find","o","push","names","undefined","innerNames","join","getContent","content","i","text","nest","innerContent","get_context","context","documentId","documentRem","visibleRemOnDocument","id","e","found","v","nameWithAnchor","nameText","split","item","idx","graphElements","index","title","fifthBreakIndex","processedTitle","substr","data","fullTitle","nodeColor","isDocument","forEach","children","length","c","source","target","target_arrow_shape","some","g","bootstrapData","makePopper","ele","ref","popperRef","dummyDomEle","tippy","onCreate","instance","popperInstance","reference","lazy","plugins","sticky","contentdiv","titleEl","appendChild","contentEl","arrow","placement","hideOnClick","multiple","interactive","appendTo","trigger","Home","useEffect","getGraphElements","filteredGraphElements","s","cytoscape","use","coseBilkent","popper","cy","container","getElementById","elements","style","selector","label","color","width","height","opacity","layout","quality","nodeDimensionsIncludeLabels","idealEdgeLength","ready","isNode","unbind","bind","event","show","hide","on","sel","difference","outgoers","union","incomers","not","addClass","removeClass","handleFocus","element","fit","$","dataset","Boolean","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.b02bd8ee.chunk.js","sourcesContent":["// import request from \"../utils/request\";\n// import { apiKey, userId } from \"../constants/common\";\n// import getIsLocal from \"../utils/isLocal\";\n\n// const isLocal = getIsLocal();\n\nconst getRemByID = (remId) => {\n  return window.RemNoteAPI.v0.get(remId);\n};\n\nexport default getRemByID;\n","function nthOccurrence(string, char, nth) {\n  var first_index = string.indexOf(char);\n  var length_up_to_first_index = first_index + 1;\n\n  if (nth === 1) {\n    return first_index;\n  } else {\n    var string_after_first_occurrence = string.slice(length_up_to_first_index);\n    var next_occurrence = nthOccurrence(\n      string_after_first_occurrence,\n      char,\n      nth - 1\n    );\n\n    if (next_occurrence === -1) {\n      return -1;\n    } else {\n      return length_up_to_first_index + next_occurrence;\n    }\n  }\n}\n\nexport default nthOccurrence;\n","export function stripHtml(html) {\n  var tmp = document.createElement('div');\n  tmp.innerHTML = html;\n  return tmp.textContent || tmp.innerText || '';\n}\n\nexport function convertStringToHtml(string) {\n  // var wrapper = document.createElement('div');\n  // wrapper.innerHTML = ;\n  // return wrapper.firstChild;\n  var parser = new DOMParser();\n  var doc = parser.parseFromString(`<div>${string}</div>`, 'text/html');\n  return doc.body.firstChild;\n}\n","import getRemByID from \"../api/getRemByID\";\nimport nthOccurrence from \"./nthOccurence\";\nimport { stripHtml } from \"./dom\";\n// import getIsLocal from \"../utils/isLocal\";\n\nconst globalSlotRems = [];\nconst contentRems = [];\n\nconst isLocal = false;\n\nasync function getName(name, visibleRems = [], remId, isWithAnchor) {\n  if (Array.isArray(name)) {\n    const names = await Promise.all(\n      name\n        .filter((n) => typeof n === \"string\" || !!n._id)\n        .map(async (r) => {\n          if (typeof r === \"string\") {\n            return r;\n          }\n\n          const existingRem = [...globalSlotRems, ...visibleRems].find(\n            (o) => o._id === r._id\n          );\n          if (existingRem) {\n            return {\n              remId: existingRem._id,\n              name: existingRem.name,\n            };\n          }\n          const a = await getRemByID(r._id);\n          globalSlotRems.push(a);\n          return {\n            remId: a._id,\n            name: a.name,\n          };\n        })\n    );\n\n    const innerNames = await Promise.all(\n      names.map(async (r) => {\n        if (typeof r === \"string\") {\n          return r;\n        }\n        return isWithAnchor\n          ? `<a href=\"#\" data-source=\"${remId}\" data-target=\"${\n              r.remId\n            }\" onclick=\"handleFocus(this)\">${await getName(\n              r.name,\n              visibleRems,\n              undefined,\n              false\n            )}</a>`\n          : getName(r.name, visibleRems, undefined, false);\n      })\n    );\n\n    return innerNames.join(\"\");\n  }\n  return \"\";\n}\n\nasync function getContent(content, visibleRems = [], remId, isWithAnchor) {\n  if (Array.isArray(content)) {\n    const nest = await Promise.all(\n      content\n        .filter((n) => typeof n === \"string\" || !!n._id)\n        .map(async (r) => {\n          if (typeof r === \"string\") {\n            return r;\n          }\n\n          if (r.i === \"m\") {\n            return r.text;\n          }\n\n          const existingRem = [...contentRems, ...visibleRems].find(\n            (o) => o._id === r._id\n          );\n          if (existingRem) {\n            return {\n              remId: existingRem._id,\n              name: existingRem.name,\n            };\n          }\n          const a = await getRemByID(r._id);\n          contentRems.push(a);\n          return {\n            remId: existingRem._id,\n            name: existingRem.name,\n          };\n        })\n    );\n\n    const innerContent = await Promise.all(\n      nest.map(async (r) => {\n        if (typeof r === \"string\") {\n          return r;\n        }\n        if (r.i === \"m\") {\n          return r.text;\n        }\n        return isWithAnchor\n          ? `<a href=\"#\" data-source=\"${remId}\" data-target=\"${\n              r.remId\n            }\" onclick=\"handleFocus(this)\">${await getName(\n              r.name,\n              visibleRems,\n              undefined,\n              false\n            )}</a>`\n          : getName(r.name, visibleRems, undefined, false);\n      })\n    );\n\n    return innerContent.join(\"\");\n  }\n  return \"\";\n}\n\nasync function bootstrapData(remId) {\n  const context = isLocal ?  undefined : await window.RemNoteAPI.v0.get_context();\n\n  const documentRem = isLocal\n    ? await getRemByID(remId)\n    : await window.RemNoteAPI.v0.get(context.documentId);\n  const visibleRems = (\n    await Promise.all(\n      documentRem.visibleRemOnDocument.map((id) => getRemByID(id))\n    )\n  ).filter((e) => e.found);\n\n  const nameWithAnchor = await Promise.all(\n    visibleRems.map((v) => getName(v.name, visibleRems, v._id, true))\n  );\n  const nameText = nameWithAnchor.map((e) =>\n    stripHtml(e)\n      .split(\" \")\n      .map((item, idx) => (idx % 2 === 0 ? item : item + \"\\n\")) // add line break to every second word\n      .join(\" \")\n  );\n  const content = await Promise.all(\n    visibleRems.map((v) => getContent(v.content, visibleRems, v._id, true))\n  );\n\n  visibleRems.push(...contentRems);\n\n  const graphElements = visibleRems\n    .map((v, index) => {\n      const title = nameText[index];\n      const fifthBreakIndex = nthOccurrence(title, \" \", 10);\n      const processedTitle =\n        fifthBreakIndex >= 0 ? `${title.substr(0, fifthBreakIndex)}...` : title;\n      return {\n        data: {\n          id: v._id,\n          title: processedTitle,\n          fullTitle: nameWithAnchor[index],\n          content: content[index],\n          nodeColor: v.isDocument ? \"yellow\" : \"red\",\n        },\n      };\n    })\n    .filter((v) => v.data.title);\n\n  visibleRems.forEach((v) => {\n    if (v.children.length > 0) {\n      graphElements.push(\n        ...v.children.map((c) => ({\n          data: {\n            source: v._id,\n            target: c,\n            target_arrow_shape: \"diamond\",\n          },\n        }))\n      );\n    }\n\n    if (Array.isArray(v.content)) {\n      graphElements.push(\n        ...v.content\n          .filter((c) => typeof c !== \"string\")\n          .map((c) => ({\n            data: {\n              source: v._id,\n              target: c._id,\n              target_arrow_shape: \"vee\",\n            },\n          }))\n      );\n    }\n\n    if (Array.isArray(v.name)) {\n      graphElements.push(\n        ...v.name\n          .filter(\n            (c) =>\n              typeof c !== \"string\" &&\n              !graphElements.some((g) => g.data.target === c._id)\n          )\n          .map((c) => ({\n            data: {\n              source: v._id,\n              target: c._id,\n              target_arrow_shape: \"vee\",\n            },\n          }))\n      );\n    }\n  });\n  return graphElements;\n}\n\nexport default bootstrapData;\n","import React, { useEffect } from \"react\";\nimport cytoscape from \"cytoscape\";\nimport popper from \"cytoscape-popper\";\nimport coseBilkent from \"cytoscape-cose-bilkent\";\nimport tippy, { sticky } from \"tippy.js\";\nimport 'tippy.js/dist/tippy.css';\nimport getGraphElements from \"./utils/buildData\";\nimport { convertStringToHtml } from \"./utils/dom\";\n\nwindow.handleFocus = function handleFocus(element) {\n  const cy = window.cy;\n  cy.fit(cy.$(`#${element.dataset.source}, #${element.dataset.target}`), 100);\n};\n\nfunction makePopper(ele) {\n  const ref = ele.popperRef();\n  const dummyDomEle = document.createElement(\"div\");\n  ele.tippy = tippy(dummyDomEle, {\n    onCreate: function (instance) {\n      instance.popperInstance.reference = ref;\n    },\n    lazy: false, // mandatory\n    plugins: [sticky],\n    content: () => {\n      const contentdiv = document.createElement(\"div\");\n      const { fullTitle, content } = ele.data();\n      const titleEl = document.createElement(\"h3\");\n      titleEl.appendChild(convertStringToHtml(fullTitle));\n      contentdiv.appendChild(titleEl);\n\n      if (content) {\n        const contentEl = document.createElement(\"div\");\n        contentEl.appendChild(convertStringToHtml(content));\n        contentdiv.appendChild(contentEl);\n      }\n\n      return contentdiv;\n    },\n    arrow: true,\n    placement: \"bottom\",\n    hideOnClick: false,\n    multiple: true,\n    // if interactive:\n    interactive: true,\n    sticky: true,\n    appendTo: document.body, // or append dummyDomEle to document.body\n    trigger: \"manual\", //when use program to handle\n  });\n}\n\nexport default function Home() {\n  useEffect(() => {\n    async function bootstrapData() {\n      const graphElements = await getGraphElements(\"GH5MRkMCJ6R6aoLbB\");\n      const filteredGraphElements = graphElements.filter((i) =>\n        i.data.title\n          ? true\n          : graphElements.some((s) => s.data.id === i.data.source) &&\n            graphElements.some((s) => s.data.id === i.data.target)\n      );\n      cytoscape.use(coseBilkent);\n      cytoscape.use(popper);\n      const cy = cytoscape({\n        container: document.getElementById(\"cy\"),\n        elements: filteredGraphElements,\n        style: [\n          {\n            selector: \"node\",\n            style: {\n              \"background-color\": \"data(nodeColor)\",\n              label: \"data(title)\",\n              color: \" #66ff66\",\n              \"font-size\": \"10px\",\n              \"text-wrap\": \"wrap\",\n              \"text-overflow-wrap\": \"anywhere\"\n            },\n          },\n          {\n            selector: \"node[[degree = 0]]\",\n            style: {\n              width: 8,\n              height: 8,\n            },\n          },\n          {\n            selector: \"node[[degree >= 1]][[degree <= 3]]\",\n            style: {\n              width: 10,\n              height: 10,\n            },\n          },\n          {\n            selector: \"node[[degree > 3]][[degree <= 5]]\",\n            style: {\n              width: 12,\n              height: 12,\n            },\n          },\n          {\n            selector: \"node[[degree > 5]][[degree <= 7]]\",\n            style: {\n              width: 14,\n              height: 14,\n            },\n          },\n          {\n            selector: \"node[[degree > 7]][[degree <= 9]]\",\n            style: {\n              width: 16,\n              height: 16,\n            },\n          },\n          {\n            selector: \"node[[degree > 9]]\",\n            style: {\n              width: 18,\n              height: 18,\n            },\n          },\n          {\n            selector: \"edge\",\n            style: {\n              width: 1,\n              \"line-color\": \"#ccc\",\n              \"target-arrow-color\": \"#ccc\",\n              \"target-arrow-shape\": \"data(target_arrow_shape)\",\n              \"curve-style\": \"bezier\",\n              \"arrow-scale\": 1,\n              label: \"data(label)\",\n              color: \"green\",\n              \"font-size\": \"7px\",\n              \"text-wrap\": \"wrap\",\n            },\n          },\n          {\n            selector: \"node.highlight\",\n            style: {\n              \"border-color\": \"#FFF\",\n              \"border-width\": \"1px\",\n            },\n          },\n          {\n            selector: \"node.semitransp\",\n            style: { opacity: \"0.2\" },\n          },\n          {\n            selector: \"edge.highlight\",\n            style: { \"mid-target-arrow-color\": \"#FFF\" },\n          },\n          {\n            selector: \"edge.semitransp\",\n            style: { opacity: \"0.2\" },\n          },\n        ],\n        layout: {\n          name: \"cose-bilkent\",\n          quality: \"default\",\n          // Whether to include labels in node dimensions. Useful for avoiding label overlap\n          nodeDimensionsIncludeLabels: true,\n          idealEdgeLength: 50,\n        },\n      });\n\n      cy.ready(function () {\n        window.cy = cy;\n        cy.elements().forEach(function (ele) {\n          if (ele.isNode()) {\n            makePopper(ele);\n            ele.unbind(\"select\");\n            ele.bind(\"select\", (event) => event.target.tippy.show());\n\n            ele.unbind(\"unselect\");\n            ele.bind(\"unselect\", (event) => event.target.tippy.hide());\n          }\n        });\n\n        cy.on(\"mouseover\", \"node\", function (e) {\n          var sel = e.target;\n          cy.elements()\n            .difference(sel.outgoers().union(sel.incomers()))\n            .not(sel)\n            .addClass(\"semitransp\");\n          sel\n            .addClass(\"highlight\")\n            .outgoers()\n            .union(sel.incomers())\n            .addClass(\"highlight\");\n        });\n        cy.on(\"mouseout\", \"node\", function (e) {\n          var sel = e.target;\n          cy.elements().removeClass(\"semitransp\");\n          sel\n            .removeClass(\"highlight\")\n            .outgoers()\n            .union(sel.incomers())\n            .removeClass(\"highlight\");\n        });\n      });\n    }\n    bootstrapData();\n  }, []);\n  return (\n    <div>\n      <div id=\"cy\" />\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}